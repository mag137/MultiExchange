import tkinter as tk
from typing import Literal
import itertools

"""
–≠—Ç–æ—Ç –∫–ª–∞—Å—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Tkinter —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ, 
–∏–∑–º–µ–Ω–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–±—Ä–æ—Å–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞) —á–µ—Ä–µ–∑ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

‚öô –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã.
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (header) –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö.
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö.
‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –≤ –ø—Ä–æ–±—Ä–æ—Å–µ –ª—é–±—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ tk.Label —á–µ—Ä–µ–∑ –≤—Ö–æ–¥–Ω–æ–π —Å–ª–æ–≤–∞—Ä—å (fg, bg, relief –∏ —Ç. –¥.).
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ None –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö ‚Äî –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –∑–∞–¥–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
‚úÖ –ì–∏–±–∫–∞—è —Ä–∞–±–æ—Ç–∞ —Å grid_rowconfigure –∏ grid_columnconfigure –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã.

üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞
__init__()          ‚Äì —Å–æ–∑–¥–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ Tkinter, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Frame) –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Ä–∏—Å–æ–≤–∫–∏.
create_cell_label() ‚Äì —Å–æ–∑–¥–∞–µ—Ç —è—á–µ–π–∫—É —Ç–∞–±–ª–∏—Ü—ã (tk.Label) —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.
update_greed_data() ‚Äì –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É, –∏–∑–º–µ–Ω—è—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—è –Ω–æ–≤—ã–µ —è—á–µ–π–∫–∏.

üìå –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–§–æ—Ä–º–∞—Ç —Å–ª–æ–≤–∞—Ä—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
data = {
    'header':   {0: {'text': '–ò–º—è'}, 1: {'text': '–í–æ–∑—Ä–∞—Å—Ç'}},
    1:          {0: {'text': '–ê–ª–µ–∫—Å', 'fg': None}, 1: {'text': '30', 'fg': 'red'}},
    2:          {0: {'text': '–ú–∞—Ä–∏—è', 'fg': 'blue'}, 1: {'text': '25'}}
}
–≥–¥–µ:
    "header" ‚Äì –∑–∞–¥–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏.
    fg ‚Äì —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ (–µ—Å–ª–∏ None, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ü–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    text ‚Äì —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —è—á–µ–π–∫–∏.
    
üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:
–ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è/—É–±–∏—Ä–∞—é—Ç—Å—è –∫–æ–ª–æ–Ω–∫–∏ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∏), –∫–ª–∞—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–µ—Ç —è—á–µ–π–∫–∏.
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–æ–ª–±–µ—Ü –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–≤–æ—é —à–∏—Ä–∏–Ω—É.
–ó–Ω–∞—á–µ–Ω–∏—è None –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö (fg, bg) –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –æ—à–∏–±–æ–∫, –∞ –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ tk.Label.

üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
–ö–ª–∞—Å—Å –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è, –Ω–æ –≥–∏–±–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ Tkinter, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
"""

class TkinterDisplayGrid:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("Display title")
        self.cells = {}  # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–æ–∫ —è—á–µ–µ–∫
        self.frame1 = tk.Frame(self.root)  # ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –∫ root
        self.frame1.pack(expand=True, fill="both")  # ‚úÖ –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Å—ë –æ–∫–Ω–æ
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —è—á–µ–π–∫–∏
        self.font = ("Arial", 10)   # –®—Ä–∏—Ñ—Ç –≤ —è—á–µ–π–∫–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        self.borderwidth = 1        # –¢–æ–ª—â–∏–Ω–∞ –≥—Ä–∞–Ω–∏—Ü —è—á–µ–π–∫–∏
        self.relief: Literal["raised", "sunken", "flat", "ridge", "solid", "groove"] = "solid"
        self.default_fg = 'black'   # ‚úÖ –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        self.default_bg = '#D9D9D9'  # ‚úÖ –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

    def create_cell_label(self, text: str, row: int, column: int, width: int,
                          round_: int | None = None, **kwargs):
        """–°–æ–∑–¥–∞–µ—Ç Label —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

        :param text: –¢–µ–∫—Å—Ç –≤ —è—á–µ–π–∫–µ.
        :param row: –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ —Å–µ—Ç–∫–µ.
        :param column: –ù–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞ –≤ —Å–µ—Ç–∫–µ.
        :param width: –®–∏—Ä–∏–Ω–∞ —è—á–µ–π–∫–∏.
        :param round_: –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —á–∏—Å–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
        :param kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Label (–Ω–∞–ø—Ä–∏–º–µ—Ä, fg, bg).
        :return: –û–±—ä–µ–∫—Ç Label.
        """
        label = tk.Label(self.frame1, text=text, font=self.font,
                         fg=kwargs.get('fg', self.default_fg),
                         bg=kwargs.get('bg', self.default_bg),
                         borderwidth=self.borderwidth, relief=self.relief,
                         width=width)
        label.grid(row=row, column=column, sticky="nsew")

        # ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–ª–æ–≤–∞—Ä—å
        self.cells[(row, column)] = label

        return label

    def update_greed_data(self, greed_data: dict | None = None, title: str = 'Display title'):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Ç–∫–µ.

        :param greed_data: –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —è—á–µ–µ–∫.
        :param title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞.
        """
        if greed_data is None:
            greed_data = {'header': {0: {'text': 'test'}}}

        self.root.title(title)  # ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞

        # ‚úÖ –û—á–∏—â–∞–µ–º –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —è—á–µ–π–∫–∏
        existing_keys = set(self.cells.keys())
        new_keys = {(row if row != 'header' else 0, col) for row, row_data in greed_data.items() for col in row_data}
        to_remove = existing_keys - new_keys

        for key in to_remove:
            self.cells[key].destroy()
            del self.cells[key]

        for row, row_data in greed_data.items():
            row = 0 if row == 'header' else row
            for col, cell_data in row_data.items():
                text = cell_data.get('text', '')  # ‚úÖ –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ —Å–ª–æ–≤–∞—Ä—è
                fg = cell_data.get('fg', self.default_fg)  # ‚úÖ –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
                bg = cell_data.get('bg', self.default_bg)  # ‚úÖ –¶–≤–µ—Ç —Ñ–æ–Ω–∞

                # ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —à–∏—Ä–∏–Ω—É —è—á–µ–π–∫–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É —Ç–µ–∫—Å—Ç–∞
                width = max(10, len(text) + 2)

                # ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ —è—á–µ–µ–∫
                self.frame1.grid_rowconfigure(row, weight=1)
                self.frame1.grid_columnconfigure(col, weight=1)

                # ‚úÖ –ï—Å–ª–∏ —è—á–µ–π–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º
                if (row, col) in self.cells:
                    self.cells[(row, col)].config(text=text, fg=fg, bg=bg, width=width)
                else:
                    # ‚úÖ –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é —è—á–µ–π–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
                    self.create_cell_label(text, row=row, column=col, width=width, fg=fg, bg=bg)


# ‚úÖ –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç
a = TkinterDisplayGrid()

# ‚úÖ –≠–º—É–ª—è—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 —Å–µ–∫—É–Ω–¥–∞
import time

data_variants = itertools.cycle([
    {
        'header': {0: {'text': '–ò–º—è'}, 1: {'text': '–í–æ–∑—Ä–∞—Å—Ç'}},
        1: {0: {'text': '–ê–ª–µ–∫—Å', 'fg': None}, 1: {'text': '30', 'fg': None}},
        2: {0: {'text': '–ú–∞—Ä–∏—è', 'fg': 'cyan'}, 1: {'text': '25', 'fg': None}}
    },
    {
        'header': {0: {'text': '–ò–º—è'}, 1: {'text': '–í–æ–∑—Ä–∞—Å—Ç'}, 2: {'text': '–ì–æ—Ä–æ–¥'}},
        1: {0: {'text': '–í–∞—Å—è'}, 1: {'text': '40'}, 2: {'text': '–ú–æ—Å–∫–≤–∞', 'fg': 'blue'}},
        2: {0: {'text': '–ö–∞—Ç—è'}, 1: {'text': '18'}, 2: {'text': '–°–æ—á–∏', 'fg': 'green'}}
    },
    {
        'header': {0: {'text': '–ü—Ä–æ–¥—É–∫—Ç'}, 1: {'text': '–¶–µ–Ω–∞', 'fg': 'red'}},
        1: {0: {'text': '–Ø–±–ª–æ–∫–∏'}, 1: {'text': '100 —Ä—É–±.', 'fg': None}},
        2: {0: {'text': '–ë–∞–Ω–∞–Ω—ã'}, 1: {'text': '80 —Ä—É–±.', 'fg': 'purple'}}
    }
])

def update_data_loop():
    """–§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫—É–Ω–¥—É."""
    while True:
        a.update_greed_data(next(data_variants))
        time.sleep(1)


# ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
import threading
threading.Thread(target=update_data_loop, daemon=True).start()

# ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
a.root.mainloop()
