Отложили биржу HTX - арбитраж спот/своп не интересен, нет красивых спредов, особенно при закрытии арбитражной пары.
Причина - скорее всего на бирже стоят собственные арбиражные роботы для ликвидности, которые съедают основные ничтяки

Попробовал Gate - будем посмотреть.
Есть ньюанс в работе - сокет-подписка на баланс не дает вначале балансы, только при изменении.
Поэтому при старте робота запускаем polong-запрос (fetch_balance)
У GATE отдельный счет для спота и своп. Для выравнивания необходимо получать два баланса и переводами выравнивать
В дальнейшем нужно будет сделать разделение процесса arbitrage_pairs на несколько процессов для снижения нагрузки на event loop
Gate - ужасный апи - получение котировок идет не регулярно. Проверил - открыть сделку по сигналу практически невозможно ибо тайна полета пули по какой цене отработает сделка.

Попробуем OKX - кажется у него общий счет для свопов и спотов, что замечательно

вид стакана:
{'asks': [[93232.0, 1.35438473], [93232.3, 0.09983606], [93232.8, 0.1733656], [93232.9, 0.007508], [93233.0, 0.2468], [93233.6, 0.01659215], [93234.0, 0.0667], [93234.7, 0.0052463], [93234.9, 1.077e-05], [93236.0, 0.0667], [93237.9, 0.08681829], [93238.0, 0.0667], [93238.4, 1.077e-05], [93238.6, 0.001526], [93238.8, 0.11333209], [93239.0, 0.0667], [93239.4, 0.08077223], [93240.3, 0.05364032], [93241.3, 0.00536473], [93241.4, 0.01494008], [93241.5, 0.07343033], [93241.8, 1.077e-05], [93242.5, 0.00750831], [93242.9, 0.05236117], [93243.3, 0.01700349], [93243.4, 0.02355522], [93243.5, 0.02251086], [93243.6, 0.04684916], [93243.7, 0.02881632], [93243.8, 0.0729103], [93244.0, 0.34934785], [93244.1, 0.77155739], [93244.9, 0.00545825], [93245.1, 0.0272], [93245.3, 1.077e-05], [93245.8, 0.01], [93246.0, 0.02055571], [93246.1, 0.00055588], [93246.2, 0.00055571], [93246.3, 0.00055573], [93246.4, 0.00055571], [93246.5, 0.02435587], [93246.6, 0.0005557], [93246.7, 0.00055571], [93246.8, 0.00055572], [93246.9, 0.0005559], [93247.0, 0.02605571], [93247.1, 0.0005557], [93247.2, 0.00055573], [93247.3, 0.00055589], [93247.4, 0.00055569], [93247.5, 0.0260557], [93247.6, 0.00055572], [93247.7, 0.0005559], [93247.8, 0.00055567], [93247.9, 0.183], [93248.0, 0.06775879], [93248.1, 0.0219758], [93248.2, 0.00055592], [93248.3, 0.00055575], [93248.4, 0.02605584], [93248.5, 0.81453642], [93248.6, 0.78155739], [93248.7, 0.00112236], [93248.8, 0.0238], [93248.9, 0.06401178], [93249.0, 0.00055575], [93249.1, 0.00055584], [93249.2, 0.00055582], [93249.3, 0.00055594], [93249.4, 0.00055573], [93249.5, 0.00055582], [93249.6, 0.08602583], [93249.7, 0.00545594], [93249.8, 0.02605574], [93249.9, 0.00592081], [93250.0, 0.00545585], [93250.1, 0.00055595], [93250.2, 0.00055566], [93250.3, 0.00055584], [93250.4, 0.00055585], [93250.5, 0.00055594], [93250.6, 0.00055565], [93250.7, 0.00055585], [93250.8, 0.00055585], [93250.9, 0.00062793], [93251.0, 0.00055567], [93251.1, 0.00055585], [93251.2, 0.00055585], [93251.3, 0.00055595], [93251.4, 0.00055567], [93251.5, 0.00612328], [93251.6, 0.00055585], [93251.7, 0.05495595], [93251.8, 0.00270072], [93251.9, 0.00055586], [93252.0, 0.00055584], [93252.1, 0.00055596], [93252.2, 0.00056644], [93252.3, 0.51492745], [93252.4, 0.77211322], [93252.5, 0.00055595], [93252.6, 0.07367066], [93252.7, 0.00055585], [93252.8, 0.43936471], [93252.9, 0.00055597], [93253.0, 0.58252169], [93253.1, 0.00055583], [93253.2, 0.00055584], [93253.3, 0.00055599], [93253.4, 0.00055568], [93253.5, 0.00055583], [93253.6, 0.00055583], [93253.7, 0.00055599], [93253.8, 0.00055568], [93253.9, 0.00055587], [93254.0, 0.00055586], [93254.1, 0.00055595], [93254.2, 0.00055569], [93254.3, 0.00055586], [93254.4, 0.00055586], [93254.5, 0.00055597], [93254.6, 0.00055571], [93254.7, 0.00055584], [93254.8, 0.00055588], [93254.9, 0.00055597], [93255.0, 0.00055572], [93255.1, 0.03655584], [93255.2, 0.00055588], [93255.3, 0.00055596], [93255.4, 0.00055571], [93255.5, 0.00055586], [93255.6, 0.00056656], [93255.7, 0.00055596], [93255.8, 0.0005557], [93255.9, 0.00055583], [93256.0, 0.00057578], [93256.1, 0.00055596], [93256.2, 0.03655569], [93256.3, 0.00055577], [93256.4, 0.00055579], [93256.5, 0.00055595], [93256.6, 0.77211308], [93256.7, 0.00055576], [93256.8, 0.03655578], [93256.9, 0.00055594], [93257.0, 0.00055569], [93257.1, 0.00055575], [93257.2, 0.00055581], [93257.3, 0.00055595], [93257.4, 0.00055569], [93257.5, 0.00055574], [93257.6, 0.6990823], [93257.7, 0.00055588], [93257.8, 0.00055572], [93257.9, 0.00055573], [93258.0, 0.00055578], [93258.1, 0.00055588], [93258.2, 0.00055571], [93258.3, 0.00055568], [93258.4, 0.00587171], [93258.5, 0.00055588], [93258.6, 0.00055572], [93258.7, 0.00055569], [93258.8, 0.00055578], [93258.9, 0.00055588], [93259.0, 0.08775574], [93259.1, 0.04984522], [93259.2, 0.00055575], [93259.3, 0.00055589], [93259.4, 0.00055572], [93259.5, 0.00055568], [93259.6, 0.00085585], [93259.7, 0.00055588], [93259.8, 0.0005557], [93259.9, 0.00055568], [93260.0, 0.00055575], [93260.1, 0.00055588], [93260.2, 0.00055571], [93260.3, 0.00055571], [93260.4, 0.00055573], [93260.5, 0.15805589], [93260.6, 0.0005557], [93260.7, 0.0005557], [93260.8, 0.00055572], [93260.9, 0.92203843], [93261.0, 0.00066297], [93261.1, 0.0005557], [93261.2, 0.00055572], [93261.3, 0.00055588], [93261.4, 0.7721131], [93261.5, 0.51492731], [93261.6, 0.00055571], [93261.7, 0.00066314], [93261.8, 0.00055571], [93261.9, 0.00057076], [93262.0, 0.00055571], [93262.1, 0.00055588], [93262.2, 0.00055571], [93262.3, 0.00055573], [93262.4, 0.00055571], [93262.5, 0.13077133], [93262.6, 0.05857349], [93262.7, 0.00545571], [93262.8, 0.00055572], [93262.9, 0.0005559], [93263.0, 0.00055571], [93263.1, 0.0005557], [93263.2, 0.00066298], [93263.3, 0.00055589], [93263.4, 0.00055569], [93263.5, 0.0005557], [93263.6, 0.00055572], [93263.7, 0.0005559], [93263.8, 0.00055567], [93264.0, 0.25424162], [93264.1, 0.04055877], [93264.2, 0.00055592], [93264.3, 0.02210675], [93264.4, 0.00055584], [93264.5, 0.00111175], [93264.7, 0.00111159], [93264.8, 0.00010725], [93264.9, 0.00116542], [93265.0, 0.00055575], [93265.1, 0.00055584], [93265.2, 0.00055582], [93265.3, 0.00055594], [93265.4, 0.00055573], [93265.5, 0.00066307], [93265.6, 0.00055583], [93265.7, 0.00055594], [93265.8, 0.00055574], [93265.9, 0.00055583], [93266.0, 0.77212401], [93266.1, 0.00055595], [93266.2, 0.02855119], [93266.3, 0.00055584], [93266.4, 0.00055585], [93266.5, 0.00055594], [93266.6, 0.00055565], [93266.7, 0.00055585], [93266.8, 0.00055585], [93266.9, 0.00055594], [93267.0, 0.21859115], [93267.1, 0.51492745], [93267.2, 0.00055585], [93267.3, 0.00055595], [93267.4, 0.02198567], [93267.5, 0.00055586], [93267.6, 0.00055585], [93267.7, 0.00055595], [93267.8, 0.00055567], [93267.9, 0.00055586], [93268.0, 0.00055584], [93268.1, 0.00055596], [93268.2, 0.01255567], [93268.3, 0.00655585], [93268.4, 0.00055583], [93268.5, 0.00055595], [93268.6, 0.00055566], [93268.7, 0.00055585], [93268.8, 0.00055582], [93268.9, 0.00055597], [93269.0, 0.00055569], [93269.1, 0.00055583], [93269.2, 0.00055584], [93269.3, 0.00055599], [93269.4, 0.03656645], [93269.5, 0.00055583], [93269.6, 0.00055583], [93269.7, 0.00055599], [93269.8, 0.00055568], [93269.9, 0.08642879], [93270.0, 0.00066309], [93270.1, 0.00055595], [93270.2, 0.00055569], [93270.3, 0.00055586], [93270.4, 0.01014563], [93270.5, 0.00055597], [93270.6, 0.01036837], [93270.7, 0.00055584], [93270.8, 0.00066311], [93270.9, 0.00055597], [93271.0, 0.00055572], [93271.1, 0.00055584], [93271.2, 0.00057088], [93271.3, 0.00055596], [93271.4, 0.00055571], [93271.5, 0.00066309], [93271.6, 0.00055579], [93271.7, 0.00055596], [93271.8, 0.0005557], [93271.9, 0.46720583], [93272.0, 0.00055578], [93272.1, 0.00055596], [93272.2, 0.00055569], [93272.3, 0.000663], [93272.4, 0.01306706], [93272.5, 0.00055595], [93272.6, 0.15805569], [93272.7, 0.00055576], [93272.8, 0.00055578], [93272.9, 0.00056671], [93273.0, 0.00055569], [93273.1, 0.00066298], [93273.2, 0.00055581], [93273.3, 0.00055595], [93273.4, 0.00055569], [93273.5, 0.00055574], [93273.6, 0.00055578], [93273.7, 0.00055588], [93273.8, 0.00055572], [93273.9, 0.00055573], [93274.0, 0.00055578], [93274.1, 0.02197588], [93274.2, 0.00055571], [93274.3, 0.00055568], [93274.4, 0.00055577], [93274.5, 0.00055588], [93274.6, 0.01079267], [93274.7, 0.00055569], [93274.8, 0.00055578], [93274.9, 0.00055588], [93275.0, 0.00055574], [93275.1, 0.00055569], [93275.2, 0.02165328], [93275.3, 0.00058622], [93275.4, 0.77214344], [93275.5, 0.00484554], [93275.6, 0.00055574], [93275.7, 0.00055588], [93275.8, 0.0005557], [93275.9, 0.00055568], [93276.0, 0.00055575], [93276.1, 0.00055588], [93276.2, 0.58237671], [93276.3, 0.00056648], [93276.4, 0.00055573], [93276.5, 0.00055589], [93276.6, 0.0005557], [93276.7, 0.0005557], [93276.8, 0.51492732], [93276.9, 0.00055587], [93277.0, 0.00055571], [93277.1, 0.0694857], [93277.2, 0.04055869], [93277.3, 0.02016786], [93277.4, 0.46960571], [93277.5, 0.00055571], [93277.6, 0.00055571], [93277.7, 0.00055588], [93277.8, 0.00055571], [93277.9, 0.00055576], [93278.0, 0.00055571], [93278.1, 0.00055588], [93278.2, 0.00055571], [93278.3, 0.00055573], [93278.4, 0.00055571], [93278.5, 0.00055587], [93278.6, 0.0005557], [93278.7, 0.01066507], [93278.8, 0.01067695], [93278.9, 0.00442733], [93279.0, 0.01070918], [93279.1, 0.0005557], [93279.2, 0.00055573], [93279.3, 0.00055589], [93279.4, 0.01755569], [93279.5, 0.0005557], [93279.6, 0.00473183], [93279.7, 0.0005559], [93279.8, 0.00056644], [93279.9, 0.00010723], [93280.0, 0.00059921], [93280.1, 0.0005558], [93280.2, 0.00055592], [93280.3, 0.01734914], [93280.4, 0.00055584], [93280.5, 0.00112675], [93280.6, 0.00010723], [93280.7, 0.00111159], [93280.9, 0.00111178], [93281.0, 0.00805995], [93281.1, 0.10055584], [93281.2, 0.00055582], [93281.3, 0.00055594], [93281.4, 0.34397096], [93281.5, 0.00055582], [93281.6, 0.00055583], [93281.7, 0.01017631], [93281.8, 0.01023817], [93281.9, 0.00055583], [93282.0, 0.15805585], [93282.1, 0.00066318], [93282.2, 0.00055566], [93282.3, 0.01127598], [93282.4, 0.00055585], [93282.5, 0.00055594], [93282.6, 0.00055565]],
 'bids': [[93231.9, 0.66950053], [93231.0, 0.0667], [93230.1, 0.02363772], [93230.0, 0.07203595], [93229.9, 0.00055576], [93229.8, 0.00055571], [93229.7, 0.00055588], [93229.6, 0.00055571], [93229.5, 0.00055571], [93229.4, 0.00055571], [93229.3, 0.00055588], [93229.2, 0.00055572], [93229.1, 0.00056572], [93229.0, 0.06731123], [93228.9, 0.00055587], [93228.8, 0.00055572], [93228.7, 0.0005557], [93228.6, 0.0005557], [93228.5, 0.00055589], [93228.4, 0.00147007], [93228.3, 0.00055571], [93228.2, 0.00055571], [93228.1, 0.00056665], [93228.0, 0.00055575], [93227.9, 0.00055568], [93227.8, 0.0005557], [93227.7, 0.0697561], [93227.6, 0.00500145], [93227.5, 0.00060931], [93227.4, 0.00055572], [93227.3, 0.00055589], [93227.2, 0.00055575], [93227.1, 0.00055569], [93227.0, 0.00055574], [93226.9, 0.00055588], [93226.8, 0.00055578], [93226.7, 0.00055569], [93226.6, 0.00055572], [93226.5, 0.00055588], [93226.4, 0.00055577], [93226.3, 0.00055568], [93226.2, 0.00055571], [93226.1, 0.00055588], [93226.0, 0.0024831], [93225.9, 0.00055573], [93225.8, 0.00065508], [93225.7, 0.00055588], [93225.6, 0.00055578], [93225.5, 0.00055574], [93225.4, 0.00055569], [93225.3, 0.06361052], [93225.2, 0.1068963], [93225.1, 0.00055575], [93225.0, 0.00198281], [93224.9, 0.00055594], [93224.8, 0.02847167], [93224.7, 0.03570521], [93224.6, 0.00055569], [93224.5, 0.17374629], [93224.4, 0.00055579], [93224.3, 0.00055577], [93224.2, 0.00055569], [93224.1, 0.00055596], [93224.0, 0.00056655], [93223.9, 0.00055583], [93223.8, 0.0005557], [93223.7, 0.21515677], [93223.6, 0.01759606], [93223.5, 0.16145586], [93223.4, 0.00055571], [93223.3, 0.00055596], [93223.2, 0.00055588], [93223.1, 0.00055584], [93223.0, 0.00055572], [93222.9, 0.00055597], [93222.8, 0.00055588], [93222.7, 0.0220119], [93222.6, 0.00055571], [93222.5, 0.00057745], [93222.4, 0.00055586], [93222.3, 0.00055586], [93222.2, 0.00055569], [93222.1, 0.00055595], [93222.0, 0.05055586], [93221.9, 0.00055587], [93221.8, 0.00055568], [93221.7, 0.00055599], [93221.6, 0.00055583], [93221.5, 0.00055583], [93221.4, 0.00270143], [93221.3, 0.00055599], [93221.2, 0.00055584], [93221.1, 0.0636104], [93221.0, 0.00055569], [93220.9, 0.00518129], [93220.8, 0.00055582], [93220.7, 0.00058591], [93220.6, 0.00055566], [93220.5, 0.10760891], [93220.4, 0.00055583], [93220.3, 0.00055585], [93220.2, 0.00055567], [93220.1, 0.06361053], [93220.0, 0.00055584], [93219.9, 0.00055586], [93219.8, 0.00055567], [93219.7, 0.01755595], [93219.6, 0.06391053], [93219.5, 0.19657207], [93219.4, 0.00055567], [93219.3, 0.01755595], [93219.2, 0.00055585], [93219.1, 0.00055585], [93219.0, 0.00055567], [93218.9, 0.00055594], [93218.8, 0.01757734], [93218.7, 0.01055585], [93218.6, 0.00055565], [93218.5, 0.00055594], [93218.4, 0.03455585], [93218.3, 0.00060947], [93218.2, 0.00055566], [93218.1, 0.02055595], [93218.0, 0.00055585], [93217.9, 0.01755583], [93217.8, 0.00062478], [93217.7, 0.00055594], [93217.6, 0.00055583], [93217.5, 0.00055582], [93217.4, 0.03455573], [93217.3, 0.00055594], [93217.2, 0.00055582], [93217.1, 0.06361041], [93217.0, 0.00055575], [93216.9, 0.00111178], [93216.8, 0.00536473], [93216.7, 0.00582942], [93216.5, 0.01811175], [93216.4, 0.00055584], [93216.3, 0.00055575], [93216.2, 0.00055592], [93216.1, 0.06361037], [93216.0, 0.00055582], [93215.8, 0.06361024], [93215.7, 0.10787201], [93215.6, 0.00055572], [93215.5, 0.1580557], [93215.4, 0.00056646], [93215.3, 0.00545589], [93215.2, 0.00055573], [93215.1, 0.00057718], [93215.0, 0.00055571], [93214.9, 0.05419792], [93214.8, 0.00055572], [93214.7, 0.01755571], [93214.6, 0.48147248], [93214.5, 0.00055587], [93214.4, 0.01755571], [93214.3, 0.00055573], [93214.2, 0.00062451], [93214.1, 0.00055588], [93214.0, 0.00055571], [93213.9, 0.00055576], [93213.8, 0.00055571], [93213.7, 0.06855588], [93213.6, 0.00055571], [93213.5, 0.00033559], [93213.4, 0.00061444], [93213.3, 0.77211327], [93213.2, 0.51492732], [93213.1, 0.1311061], [93213.0, 0.09087571], [93212.9, 0.00055587], [93212.8, 0.00055572], [93212.7, 0.0005557], [93212.6, 0.0005557], [93212.5, 0.00055589], [93212.4, 0.00055573], [93212.3, 0.00061263], [93212.2, 0.00055571], [93212.1, 0.00055588], [93212.0, 0.00055575], [93211.9, 0.00055568], [93211.8, 0.0005557], [93211.7, 0.00055588], [93211.6, 0.00055574], [93211.5, 0.00055568], [93211.4, 0.00055572], [93211.3, 0.00055589], [93211.2, 0.00061046], [93211.1, 0.0005683], [93211.0, 0.00055574], [93210.9, 0.00056665], [93210.8, 0.00055578], [93210.7, 0.00055569], [93210.6, 0.05369278], [93210.5, 0.00055588], [93210.4, 0.00055577], [93210.3, 0.00055568], [93210.2, 0.00714637], [93210.1, 0.00055588], [93210.0, 0.43307475], [93209.9, 0.00055573], [93209.8, 0.00055572], [93209.7, 0.00055588], [93209.6, 0.00069695], [93209.5, 0.00055574], [93209.4, 0.00515941], [93209.3, 0.00055595], [93209.2, 0.00055581], [93209.1, 0.00055575], [93209.0, 0.00061458], [93208.9, 0.00055594], [93208.8, 0.00055578], [93208.7, 0.00055576], [93208.6, 0.7721231], [93208.5, 0.00055595], [93208.4, 0.00055579], [93208.3, 0.00055577], [93208.2, 0.00055569], [93208.1, 0.00055596], [93208.0, 0.00057387], [93207.9, 0.00592081], [93207.8, 0.0005557], [93207.7, 0.00055596], [93207.6, 0.00055579], [93207.5, 0.00057734], [93207.4, 0.00056648], [93207.3, 0.00055596], [93207.2, 0.51492748], [93207.1, 0.00055584], [93207.0, 0.00055572], [93206.9, 0.00055597], [93206.8, 0.00055588], [93206.7, 0.00425584], [93206.6, 0.00055571], [93206.5, 0.00055597], [93206.4, 0.00055586], [93206.3, 0.00055586], [93206.2, 0.00055569], [93206.1, 0.15805595], [93206.0, 0.00055586], [93205.9, 0.00055587], [93205.8, 0.00055568], [93205.7, 0.00055599], [93205.6, 0.00525163], [93205.5, 0.00055583], [93205.4, 0.00055568], [93205.3, 0.000571], [93205.2, 0.00055584], [93205.1, 0.00055583], [93205.0, 0.0005707], [93204.9, 0.00057916], [93204.8, 0.77211321], [93204.7, 0.05809625], [93204.6, 0.00581732], [93204.5, 0.00055595], [93204.4, 0.00055583], [93204.3, 0.00055585], [93204.2, 0.00055567], [93204.1, 0.00055596], [93204.0, 0.00056661], [93203.9, 0.00055586], [93203.8, 0.00055567], [93203.7, 0.00055595], [93203.6, 0.00055585], [93203.5, 0.00055586], [93203.4, 0.00055567], [93203.3, 0.00055595], [93203.2, 0.00055585], [93203.1, 0.00055585], [93203.0, 0.00221828], [93202.9, 0.00545594], [93202.8, 0.00055585], [93202.7, 0.00055585], [93202.6, 0.10055565], [93202.5, 0.00055594], [93202.4, 0.00055585], [93202.3, 0.00055584], [93202.2, 0.00055566], [93202.1, 0.00055595], [93202.0, 0.00484737], [93201.9, 0.0405588], [93201.8, 0.00055574], [93201.7, 0.02304771], [93201.6, 0.00055583], [93201.5, 0.00055582], [93201.4, 0.00055573], [93201.3, 0.00055594], [93201.2, 0.00055582], [93201.1, 0.00534556], [93201.0, 1.28648474], [93200.9, 0.00389318], [93200.7, 0.00111159], [93200.5, 0.00112252], [93200.4, 0.00055584], [93200.3, 0.00055575], [93200.2, 0.01255592], [93200.1, 0.0065558], [93200.0, 0.99250477], [93199.8, 0.00055567], [93199.7, 0.0005559], [93199.6, 0.00085583], [93199.5, 0.00059578], [93199.4, 0.00055569], [93199.3, 0.00055589], [93199.2, 0.00055573], [93199.1, 0.0005557], [93199.0, 0.00055571], [93198.9, 0.0005559], [93198.8, 0.00055572], [93198.7, 0.00055571], [93198.6, 0.0005557], [93198.5, 0.00055587], [93198.4, 0.00055571], [93198.3, 0.0005665], [93198.2, 0.00055571], [93198.1, 0.00055588], [93198.0, 0.00161787], [93197.9, 0.00055576], [93197.8, 0.02201571], [93197.7, 0.00055588], [93197.6, 0.00055571], [93197.5, 0.00055571], [93197.4, 0.00055571], [93197.3, 0.00055588], [93197.2, 0.00055572], [93197.1, 0.0005557], [93197.0, 0.00055571], [93196.9, 0.00055587], [93196.8, 0.77211311], [93196.7, 0.1580557], [93196.6, 0.0005557], [93196.5, 0.90788634], [93196.4, 0.00055573], [93196.3, 0.00055571], [93196.2, 0.00108998], [93196.1, 0.00055588], [93196.0, 0.00057075], [93195.9, 0.00055568], [93195.8, 0.00067222], [93195.7, 0.00055588], [93195.6, 0.00055574], [93195.5, 0.01205728], [93195.4, 0.00055572], [93195.3, 0.01227253], [93195.2, 0.00055575], [93195.1, 0.00055569], [93195.0, 0.00055574], [93194.9, 0.00055588], [93194.8, 0.00055578], [93194.7, 0.00055569], [93194.6, 0.44988309], [93194.5, 0.00055588], [93194.4, 0.00055577], [93194.3, 0.00055568], [93194.2, 0.00055571], [93194.1, 0.00057736], [93194.0, 0.00055578], [93193.9, 0.00055573], [93193.8, 0.00055572], [93193.7, 0.00055588], [93193.6, 0.00056655], [93193.5, 0.00055574], [93193.4, 0.00055569], [93193.3, 0.00055595], [93193.2, 0.00055581], [93193.1, 0.1480018], [93193.0, 0.00057576], [93192.9, 0.00055594], [93192.8, 0.00055578], [93192.7, 0.00055576], [93192.6, 0.02243269], [93192.5, 0.00055595], [93192.4, 0.00055579], [93192.3, 0.00055577], [93192.2, 0.01070926], [93192.1, 0.00055596], [93192.0, 0.00055578], [93191.9, 0.00055583], [93191.8, 0.0005557], [93191.7, 0.00055596], [93191.6, 0.00055579], [93191.5, 0.77211325], [93191.4, 0.00055571], [93191.3, 0.00055596], [93191.2, 0.00055588], [93191.1, 0.00055584], [93191.0, 0.08775572], [93190.9, 0.04415597], [93190.8, 0.00055588], [93190.7, 0.00055584], [93190.6, 0.03628571], [93190.5, 0.00055597], [93190.4, 0.00055586], [93190.3, 0.00055586], [93190.2, 0.00056646], [93190.1, 0.00055595], [93190.0, 0.00056586], [93189.9, 0.00055587]],
 'datetime': '2026-01-06T08:41:28.003Z',
 'nonce': 68541970423,
 'symbol': 'BTC/USDT',
 'timestamp': 1767688888003}


 Сразу после запуска задач получения стаканов идет проверка наличия балансов. Пока нет балансов - нет расчета средних цен.
 Здесь необходимо получать балансы отдельной задачей внутри класса ArbitragePairs

 Также имеет смысл изменить структуру получения стаканов.
 В методе watch_orderbook имхо имеет смысл использовать групповой метод подписки на сокеты - watchOrderBookForSymbols.
 Получаем два стакана и анализируем их цены с вычислением средних в watch_orderbook.
 Для снижения нагрузки на сокет и сеть используем параметр params={'depth': 'books5'}.

 Максимум 480 subscribe/unsubscribe/login запросов за час на одно соединение (это не про символы, а про количество операций подписки/отписки) — это лимит от OKX для каждого WebSocket клиента (connection).
 Это ключевой лимит, о котором большинство разработчиков не знают.
 ОДНА ГРУППОВАЯ ПОДПИСКА - ОДНО СОЕДИНЕНИЕ!!!
 Поэтому используем watchOrderBookForSymbols на OKX!
 На данном этапе для простоты имеет смысл сделать групповые подписки на каждую арбитражную пару - группа спот-своп
 Максимум 195 соединений
 Также возможно имеет смысл вычислять средние цены сразу в задаче ордербука, чтобы бросать в очередь только усредненные цены

 orderbook = await exchange.watchOrderBookForSymbols(['BTC/USDT:USDT','BTC/USDT',], params={'depth': 'books5'})
 Ответ:

    {'asks': [[93830.2, 667.25, 0], [93830.3, 0.15, 0], [93830.4, 49.0, 0], [93830.5, 0.11, 0], [93830.6, 121.8, 0]],
     'bids': [[93830.1, 812.61, 0], [93830.0, 15.71, 0], [93829.9, 0.11, 0], [93829.7, 27.38, 0], [93829.6, 26.37, 0]],
     'datetime': '2026-01-06T11:48:45.309Z',
     'nonce': None,
     'symbol': 'BTC/USDT:USDT',
     'timestamp': 1767700125309}
    {'asks': [[93868.1, 0.81943309, 0], [93869.0, 0.04, 0], [93870.0, 0.04, 0], [93870.3, 0.02130993, 0], [93870.9, 0.04658249, 0]],
     'bids': [[93868.0, 1.6426457, 0], [93867.5, 0.01, 0], [93867.1, 0.23175425, 0], [93867.0, 0.04, 0], [93866.8, 0.074919, 0]],
     'datetime': '2026-01-06T11:48:45.409Z',
     'nonce': None,
     'symbol': 'BTC/USDT',
     'timestamp': 1767700125409}

     Структура:
     1. Первичное получение данных маркетов, их сортировка и проверка, а также последующая сборка арбитражных пар осуществляется в методе получения экземпляра класа биржи через контекст
     2. Корневое приложение app.py запускает на выполнение процессы:
        - Основной процесс analitic_process.
        - Процесс отображения окна tkinter с отображением в реальном времени арбитражных пар по критериям максимальных ратио.
        - Процесс отображения окна tkinter с отображением в реальном времени активных сделок, их PnL.
     3. В основном процессе организация подписок:
        - Получение по вебсокету баланса в реальном времени.
        - Подключение к вебсокету подписок на стаканы необходимых символов
     4. Основной класс ArbitragePairs:
        - Инициализируется на уровне класса словарь очередей, в которые передаются данные стаканов.
        - Каждый экземпляр - отдельная арбитражная пара. Он получает из очереди стаканы своих цен, вычисляет средние цены исходя из доступного баланса.
        - Экземпляр определяет порог сделки, если есть условия - сделка открывается
        4.1 Основной метод - orderbooks_compare
            - Инициируем экземпляр класса DealsManager и DealOpener
